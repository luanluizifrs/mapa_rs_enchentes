<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; padding: 0; }
        #map { width: 100%; height: 100vh; }
        .leaflet-tooltip {
            background-color: rgba(255, 255, 255, 0.95);
            border: 2px solid #ff8c00;
            border-radius: 6px;
            padding: 8px 12px;
            font-weight: bold;
            font-size: 13px;
            color: #333;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        .legend {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            line-height: 24px;
            font-size: 14px;
        }
        .legend h4 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #333;
        }
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        .legend-color {
            width: 30px;
            height: 20px;
            margin-right: 10px;
            border: 1px solid #999;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([-30.0346, -51.2177], 7);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap',
            maxZoom: 18,
            minZoom: 6
        }).addTo(map);

        var municipiosAtingidos = ["Aceguá","Agudo","Água Santa","Ajuricaba","Alecrim","Alegrete","Alegria","Alpestre","Alto Alegre","Alto Feliz","Alvorada","Amaral Ferrador","Ametista do Sul","André da Rocha","Anta Gorda","Arambaré","Araricá","Aratiba","Arroio do Meio","Arroio do Tigre","Arroio dos Ratos","Arroio Grande","Arvorezinha","Augusto Pestana","Áurea","Balneário Pinhal","Barão","Barão de Cotegipe","Barra do Guarita","Barra do Ribeiro","Barra do Rio Azul","Barra Funda","Barros Cassal","Benjamin Constant do Sul","Bento Gonçalves","Boa Vista das Missões","Boa Vista do Incra","Boa Vista do Sul","Bom Jesus","Bom Princípio","Bom Progresso","Bom Retiro do Sul","Boqueirão do Leão","Braga","Brochier","Caçapava do Sul","Cacequi","Cachoeira do Sul","Cachoeirinha","Cacique Doble","Caiçara","Camaquã","Cambará do Sul","Camargo","Campestre da Serra","Campina das Missões","Campinas do Sul","Campo Bom","Campos Borges","Candelária","Cândido Godói","Candiota","Canela","Canguçu","Canoas","Canudos do Vale","Capão do Leão","Capela de Santana","Capitão","Capivari do Sul","Carlos Barbosa","Carlos Gomes","Casca","Catuípe","Caxias do Sul","Centenário","Cerrito","Cerro Branco","Cerro Grande","Cerro Grande do Sul","Chapada","Charqueadas","Chiapetta","Ciríaco","Colinas","Colorado","Condor","Constantina","Coqueiro Baixo","Coronel Bicaco","Coronel Pilar","Cotiporã","Cristal","Cristal do Sul","Cruz Alta","Cruzaltense","Cruzeiro do Sul","David Canabarro","Derrubadas","Dezesseis de Novembro","Dilermando de Aguiar","Dois Irmãos","Dois Irmãos das Missões","Dois Lajeados","Dom Feliciano","Dom Pedro de Alcântara","Dona Francisca","Doutor Maurício Cardoso","Doutor Ricardo","Eldorado do Sul","Encantado","Encruzilhada do Sul","Engenho Velho","Entre Rios do Sul","Erebango","Erechim","Erval Grande","Erval Seco","Esmeralda","Espumoso","Estação","Esteio","Estrela","Estrela Velha","Fagundes Varela","Farroupilha","Faxinal do Soturno","Faxinalzinho","Fazenda Vilanova","Feliz","Floriano Peixoto","Flores da Cunha","Fontoura Xavier","Formigueiro","Forquetinha","Fortaleza dos Valos","Frederico Westphalen","Garibaldi","Garruchos","General Câmara","Gentil","Getúlio Vargas","Giruá","Gramado","Gramado dos Loureiros","Gramado Xavier","Gravataí","Guabiju","Guaíba","Guaporé","Harmonia","Herval","Herveiras","Humaitá","Ibarama","Ibiaçá","Ibiraiaras","Ibirapuitã","Ibirubá","Igrejinha","Ijuí","Ilópolis","Imbé","Imigrante","Independência","Inhacorá","Ipê","Iraí","Itaara","Itapuca","Itaqui","Itati","Itatiba do Sul","Ivoti","Ivorá","Jaboticaba","Jacuizinho","Jaguarão","Jaguari","Jaquirana","Jari","Jóia","Júlio de Castilhos","Lagoa Bonita do Sul","Lagoa dos Três Cantos","Lagoão","Lajeado","Lajeado do Bugre","Lavras do Sul","Liberato Salzano","Lindolfo Collor","Maçambara","Machadinho","Manoel Viana","Maquiné","Maratá","Marau","Marcelino Ramos","Mariano Moro","Marques de Souza","Mata","Mato Leitão","Maximiliano de Almeida","Miraguaí","Montauri","Monte Alegre dos Campos","Montenegro","Mormaço","Mostardas","Muçum","Muitos Capões","Muliterno","Não-Me-Toque","Nonoai","Nova Alvorada","Nova Bassano","Nova Boa Vista","Nova Bréscia","Nova Esperança do Sul","Nova Hartz","Nova Palma","Nova Petrópolis","Nova Prata","Nova Ramada","Nova Roma do Sul","Nova Santa Rita","Novo Barreiro","Novo Cabrais","Novo Hamburgo","Novo Machado","Novo Tiradentes","Novo Xingu","Osório","Paim Filho","Palmares do Sul","Palmeira das Missões","Palmitinho","Panambi","Pantano Grande","Paraí","Paraíso do Sul","Pareci Novo","Parobé","Passa Sete","Passo do Sobrado","Passo Fundo","Paulo Bento","Paverama","Pedras Altas","Pedro Osório","Pelotas","Picada Café","Pinhal","Pinhal da Serra","Pinhal Grande","Pinheirinho do Vale","Pinheiro Machado","Piratini","Planalto","Poço das Antas","Pontão","Ponte Preta","Portão","Porto Alegre","Porto Lucena","Porto Mauá","Porto Xavier","Pouso Novo","Presidente Lucena","Progresso","Protásio Alves","Putinga","Quaraí","Quevedos","Quinze de Novembro","Redentora","Relvado","Restinga Seca","Rio dos Índios","Rio Grande","Rio Pardo","Riozinho","Roca Sales","Rodeio Bonito","Rolador","Rolante","Ronda Alta","Rondinha","Roque Gonzales","Rosário do Sul","Sagrada Família","Salto do Jacuí","Salvador das Missões","Salvador do Sul","Sananduva","Santa Clara do Sul","Santa Cruz do Sul","Santa Margarida do Sul","Santa Maria","Santa Rosa","Santa Tereza","Santa Vitória do Palmar","Santana da Boa Vista","Santiago","Santo Ângelo","Santo Antônio da Patrulha","Santo Antônio do Palma","Santo Antônio do Planalto","Santo Augusto","Santo Cristo","Santo Expedito do Sul","São Borja","São Domingos do Sul","São Francisco de Assis","São Francisco de Paula","São Gabriel","São Jerônimo","São João do Polêsine","São Jorge","São José das Missões","São José do Herval","São José do Hortêncio","São José do Inhacorá","São José do Norte","São José do Ouro","São Leopoldo","São Lourenço do Sul","São Martinho","São Martinho da Serra","São Miguel das Missões","São Paulo das Missões","São Pedro das Missões","São Pedro do Sul","São Sebastião do Caí","São Sepé","São Valentim","São Valentim do Sul","São Valério do Sul","São Vendelino","São Vicente do Sul","Sapiranga","Sapucaia do Sul","Seberi","Sede Nova","Segredo","Selbach","Senador Salgado Filho","Sentinela do Sul","Serafina Corrêa","Sério","Sertão","Sete de Setembro","Severiano de Almeida","Silveira Martins","Sinimbu","Sobradinho","Soledade","Tabaí","Tapera","Taquara","Taquari","Taquaruçu do Sul","Tavares","Tenente Portela","Teutônia","Tiradentes do Sul","Toropi","Torres","Tramandaí","Travesseiro","Três Arroios","Três Coroas","Três Forquilhas","Três Palmeiras","Três Passos","Trindade do Sul","Triunfo","Tucunduva","Tunas","Tupanciretã","Tupandi","Tuparendi","Ubiretama","União da Serra","Uruguaiana","Vacaria","Vale do Sol","Vale Real","Vale Verde","Vanini","Venâncio Aires","Vera Cruz","Veranópolis","Vespasiano Correa","Viadutos","Viamão","Vicente Dutra","Victor Graeff","Vila Maria","Vila Nova do Sul","Vista Alegre","Vista Alegre do Prata","Vista Gaúcha","Vitória das Missões","Westfalia","Xangri-lá"];
        
        function normalizar(texto) {
            return texto.normalize('NFD').replace(/[̀-ͯ]/g, '').toUpperCase();
        }
        
        var municipiosAtingidosSet = new Set(municipiosAtingidos.map(m => normalizar(m)));

        function getStyle(feature) {
            var nomeMunicipio = feature.properties.name || feature.properties.Nome || feature.properties.NM_MUN || '';
            var isAtingido = municipiosAtingidosSet.has(normalizar(nomeMunicipio));
            
            return {
                fillColor: isAtingido ? '#ff8c00' : '#ffffff',
                weight: 1.5,
                opacity: 1,
                color: isAtingido ? '#ff6600' : '#999999',
                fillOpacity: isAtingido ? 0.7 : 0.3
            };
        }

        function onEachFeature(feature, layer) {
            var nomeMunicipio = feature.properties.name || feature.properties.Nome || feature.properties.NM_MUN || 'Município';
            var isAtingido = municipiosAtingidosSet.has(normalizar(nomeMunicipio));
            
            layer.bindTooltip(nomeMunicipio, {
                permanent: false,
                direction: 'center',
                className: 'leaflet-tooltip'
            });
            
            layer.on({
                mouseover: function(e) {
                    var layer = e.target;
                    layer.setStyle({
                        weight: 3,
                        color: isAtingido ? '#ff4500' : '#666',
                        fillOpacity: isAtingido ? 0.9 : 0.5
                    });
                },
                mouseout: function(e) {
                    geojsonLayer.resetStyle(e.target);
                }
            });
        }

        var geojsonLayer;
        var geoJsonUrl = 'https://raw.githubusercontent.com/tbrugz/geodata-br/master/geojson/geojs-43-mun.json';
        
        fetch(geoJsonUrl)
            .then(response => response.json())
            .then(data => {
                geojsonLayer = L.geoJSON(data, {
                    style: getStyle,
                    onEachFeature: onEachFeature
                }).addTo(map);
                map.fitBounds(geojsonLayer.getBounds());
            })
            .catch(error => console.error('Erro ao carregar GeoJSON:', error));

        // Adicionar legenda
        var legend = L.control({ position: 'bottomright' });

        legend.onAdd = function(map) {
            var div = L.DomUtil.create('div', 'legend');
            div.innerHTML = 
                '<h4>Legenda</h4>' +
                '<div class="legend-item">' +
                '<div class="legend-color" style="background-color: #ff8c00; border-color: #ff6600;"></div>' +
                '<span><strong>Municípios Atingidos (406)</strong></span>' +
                '</div>' +
                '<div class="legend-item">' +
                '<div class="legend-color" style="background-color: #ffffff; border-color: #999999;"></div>' +
                '<span>Municípios Não Atingidos</span>' +
                '</div>';
            return div;
        };

        legend.addTo(map);
    </script>
</body>
</html>
